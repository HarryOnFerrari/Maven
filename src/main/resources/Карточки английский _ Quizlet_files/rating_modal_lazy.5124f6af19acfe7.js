(window.QJP=window.QJP||[]).push([["rating_modal_lazy"],{"4juH":function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a("TSYQ"),r=a.n(n),i=a("q1tI"),s=a.n(i),l={b1:"UIText--bodyOne",b2:"UIText--bodyTwo",b3:"UIText--bodyThree",b3s:"UIText--bodyThreeSpaced",b4:"UIText--bodyFour",l1:"UIText--linkOne",ln:"UIText--linkNav",l2:"UIText--linkTwo",s1:"UIText--specialOne",s2:"UIText--specialTwo",s3:"UIText--specialThree",s4:"UIText--specialFour",s5:"UIText--specialFive",s6:"UIText--specialSix"};class d extends s.a.PureComponent{render(){var e=r()("UIText",l[this.props.type]);return s.a.createElement("span",{className:e},this.props.children)}}},XMvv:function(e,t,a){"use strict";a.r(t),a.d(t,"COMPLIMENT_ITEMS",(function(){return w})),a.d(t,"default",(function(){return H}));var n=a("yXPU"),r=a.n(n),i=(a("SYor"),a("baRz")),s=a("TSYQ"),l=a.n(s),d=(a("4mDm"),a("3bBZ"),a("bvRJ")),c=a("a08m"),o=a("q1tI"),u=a.n(o);class m extends u.a.PureComponent{constructor(){super(...arguments),this.state={hoverIndex:0},this.handleHoverOn=e=>{var{hoverIndex:t}=this.state;e!==t&&this.setState({hoverIndex:e})},this.handleHoverOff=()=>{this.setState({hoverIndex:0})}}renderStars(){var{rating:e}=this.props,{hoverIndex:t}=this.state,a=t||e;return Array.from([1,2,3,4,5],(e=>u.a.createElement("div",{className:"Rating-star","data-testid":"ratingStar",key:"star"+e,onMouseEnter:()=>this.handleHoverOn(e),onMouseLeave:this.handleHoverOff},u.a.createElement(c.a,{onClick:()=>this.props.updateRating(e)},u.a.createElement(d.a,{icon:a&&a>=e?"star":"star-empty",size:"xlarge"})))))}render(){return u.a.createElement("div",{className:"Rating"},this.renderStars())}}var h=a("JxFz"),p=a("Pxp3"),b=a("FFEN"),g=a("/i8B"),v=a("vlgG"),E=a("47yS"),R=a("dxfC"),_=a("wcmh"),O=a("niDJ"),k=a("4juH"),T=a("GCXI"),f=a("xisi"),I=a("nrsj"),S=a("RVJv");class F extends S.a{}F.MODEL_NAME="rating",F.URL_BASE="ratings",F.API_VERSION="3.4";var y=a("l6OD"),x=a("T3U7"),j=Object(i.styled)("div")({name:"Subheading",class:"s3114r0"}),C=Object(i.styled)("div")({name:"FeedbackDiv",class:"f1vhh0kh"}),U=Object(i.styled)("div")({name:"RatingCompliments",class:"r161bq3j"}),N=Object(i.styled)("span")({name:"GraySpan",class:"givgbmh"}),P=Object(i.styled)("div")({name:"Reports",class:"r1mvebz6"}),w=()=>[{icon:"comprehensive",label:Object(I.a)("rating_modal.compliments.comprehensive"),value:T.Z.COMPREHENSIVE},{icon:"engaging-format",label:Object(I.a)("rating_modal.compliments.engaging_format"),value:T.Z.ENGAGING_FORMAT},{icon:"good-refresher",label:Object(I.a)("rating_modal.compliments.good_refresher"),value:T.Z.GOOD_REFRESHER},{icon:"great-test-results",label:Object(I.a)("rating_modal.compliments.great_test_results"),value:T.Z.GREAT_TEST_RESULTS}];class H extends u.a.PureComponent{constructor(e){var t;super(e),t=this,this.handleSubmit=e=>{var{model:t,modelType:a,user:n,userRating:r,userRatingFeedback:i,userRatingValue:s}=this.props,{feedback:l,quickFeedback:d,rating:c}=this.state,o=n?n.id:null,{id:u}=t;if(e)Object(x.a)("rating_modal_skip_feedback",{modelId:u,modelType:a,userId:o}),this.handleDismiss(),this.props.onSubmitRating();else if(null!=u&&a&&null!=o){var m=i;s&&Object(x.a)("rating_modal_change_feedback",{feedback:l,modelId:u,modelType:a,prevFeedback:m,prevRating:s,quickFeedback:d,rating:c,userId:o}),this.saveRating({feedback:l,id:r?r.id:null,modelId:u,modelType:a,quickFeedback:d,rating:c,userId:o})}},this.handleUpdateFeedback=e=>{var t=e.currentTarget.value;this.setState({feedback:t})},this.handleCloseModal=()=>{this.handleSubmit(!0)},this.renderComplimentItem=e=>{var{quickFeedback:t}=this.state,a=t&&t!==e.value,n=l()("q6fgmr",{h1waoxdp:a});return u.a.createElement("div",{className:n,key:e.value,onClick:()=>this.handleUpdateQuickFeedback(e.value)},u.a.createElement(d.a,{icon:e.icon}),u.a.createElement("div",{className:"c1k7mpyy"},u.a.createElement(k.a,{type:"b4"},e.label)))},this.saveRating=e=>{this.setState({saving:!0},r()((function*(){var a=new F(e);yield a.save(),t.setState({saving:!1},(()=>{t.props.onSubmitRating(e.rating)}))})))},this.updateRating=e=>{var{rating:t}=this.state;t?this.isRatingACompliment(t)===this.isRatingACompliment(e)?this.setState({rating:e}):this.setState({feedback:null,quickFeedback:null,rating:e}):this.setState({rating:e})},this.otherReasonInputRef=u.a.createRef();var{userRatingFeedback:a,userRatingQuickFeedback:n,userRatingValue:i}=this.props;this.state={feedback:a,quickFeedback:n,rating:i,saving:!1}}handleUpdateQuickFeedback(e){this.setState({quickFeedback:e},(()=>{e===T.Z.OTHER&&this.otherReasonInputRef.current&&this.otherReasonInputRef.current.focus()}))}handleDismiss(){f.a.put("/webapi/3.4/ratings/dismiss").credentials().end()}renderRating(){return u.a.createElement(p.a,{className:"ufcq7lo"},u.a.createElement(m,{rating:this.state.rating,updateRating:this.updateRating}))}renderSubmitButton(){return u.a.createElement(h.a,{"aria-label":Object(I.a)("rating_modal.submit"),disabled:this.shouldDisableSubmitButton(),hero:!0,onClick:()=>this.handleSubmit(!1),type:"submit",width:"fill"},Object(I.a)("rating_modal.submit"))}renderHeader(){var{modelType:e}=this.props,t=Object(i.styled)("div")({name:"H",class:"hg4nshp"});switch(e){case T.L.PREP_PACK:return u.a.createElement(t,null,Object(I.a)("rating_modal.prep_pack_title"));case T.L.SET:return u.a.createElement(t,null,Object(I.a)("rating_modal.set_title"));case T.L.FOLDER:default:return u.a.createElement(t,null,Object(I.a)("rating_modal.study_guide_title"))}}renderReports(){var{quickFeedback:e}=this.state,t=e?""+e:"";return u.a.createElement(u.a.Fragment,null,u.a.createElement(b.a,{deprecatedStyle:!0,size:6},u.a.createElement(j,null,Object(I.a)("rating_modal.reports.heading"))),u.a.createElement(P,{"data-testid":"reports"},u.a.createElement(O.a,{name:"reports",onChange:e=>this.handleUpdateQuickFeedback(parseInt(e,10)),value:t},[{label:Object(I.a)("rating_modal.reports.not_enough_detail"),value:T.Z.NOT_ENOUGH_DETAIL},{label:Object(I.a)("rating_modal.reports.poorly_formatted"),value:T.Z.POORLY_FORMATTED},{label:Object(I.a)("rating_modal.reports.incomplete_or_irrelevant"),value:T.Z.INCOMPLETE_OR_IRRELEVANT},{label:Object(I.a)("rating_modal.reports.other"),value:T.Z.OTHER}].map((e=>{var t=""+e.value;return u.a.createElement(_.a,{key:t,label:e.label,value:t})}))),e===T.Z.OTHER?this.renderOtherReasonInput():null))}renderOtherReasonInput(){return u.a.createElement(C,null,u.a.createElement(g.a,null),u.a.createElement(v.a,{label:Object(I.a)("rating_modal.other_label"),onChange:this.handleUpdateFeedback,placeholder:Object(I.a)("rating_modal.other_placeholder"),ref:this.otherReasonInputRef,value:this.state.feedback||""}))}renderCompliments(){return u.a.createElement(u.a.Fragment,null,u.a.createElement(b.a,{deprecatedStyle:!0,size:6},u.a.createElement(N,null,Object(I.a)("rating_modal.compliments.heading"))),u.a.createElement(U,{"data-testid":"compliments"},w().map(this.renderComplimentItem)))}renderQuickFeedback(){var{rating:e}=this.state;return null==e?null:this.isRatingACompliment(e)?this.renderCompliments():this.renderReports()}renderRatingFollowup(){return u.a.createElement(u.a.Fragment,null,u.a.createElement(g.a,null),this.renderQuickFeedback(),this.renderSubmitButton())}renderSubTitle(){return u.a.createElement(b.a,{deprecatedStyle:!0,size:6},u.a.createElement(j,null,this.state.rating?Object(I.a)("rating_modal.after_rating_sub_title",{count:this.state.rating}):Object(I.a)("rating_modal.before_rating_sub_title")))}render(){return u.a.createElement(R.a,{fullWidthBody:Object(y.h)(),headerContent:this.renderHeader(),includeCloseButton:!0,isOpen:this.props.isOpen,onClose:this.handleCloseModal},u.a.createElement("div",{className:"m32dr6w"},this.state.saving?u.a.createElement("span",{className:"s17km577"},u.a.createElement(E.a,{size:"large"})):null,this.renderSubTitle(),this.renderRating(),this.state.rating?this.renderRatingFollowup():null))}isRatingACompliment(e){return e>3}shouldDisableSubmitButton(){var{feedback:e,quickFeedback:t,rating:a}=this.state;return!a||t===T.Z.OTHER&&(!e||0===e.trim().length)}}H.defaultProps={isOpen:!1},a("iEaF")},iEaF:function(e,t,a){"use strict";a.r(t)},niDJ:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a("pVnL"),r=a.n(n),i=a("8OQS"),s=a.n(i),l=a("Pxp3"),d=a("q1tI"),c=a.n(d),o=a("UaYY"),u=["children","value"];class m extends c.a.PureComponent{render(){var e=this.props,{children:t,value:a}=e,n=s()(e,u);return c.a.createElement(o.RadioGroup,r()({},n,{className:"UIRadioGroup",Component:l.a,selectedValue:a}),c.a.Children.map(t,(e=>c.a.isValidElement(e)?c.a.cloneElement(e,{Component:o.Radio}):null)))}}}}]);